<div class="container user-form">
  <%= form_for @user do |f| %>
    <label>姓名</label>
    <%= f.text_field :name, class: "form-control" %>
    <br>
    <label>自我介紹</label>
    <%= f.text_area :introduction, class: "form-control" %>
    <br>
    <label>照片</label>
    <input id="user_avatar" style="display:none" type="text" value="<%= @user.avatar%>" name="user[avatar]">
    <button name="button" type="button" class="btn btn-default btn-upload-image" onclick=" updateImg(event)">上傳照片</button>
    <br>
    <br>
    <%= image_tag @user.avatar, class:"img-responsive img-rounded " if @user.avatar && @user.avatar != "" %>
    <br>
    <%= f.submit '更新', class: "btn btn-default"%>
  <% end %>
</div>

<script type="text/javascript">
  window.setTimeout( function() {
    $("textarea").height( $("textarea")[0].scrollHeight );
  }, 1);

  function updateImg(){
    (function(){
        Dojo_Forum.pick().then(function(data){(function(data){const filestack_input_field= document.getElementById('user_avatar');
          filestack_input_field.value = data.filesUploaded[0].url;
          $("img").attr('src', filestack_input_field.value);
          console.log("test");
        })(data)})
    })()    
  }
</script>